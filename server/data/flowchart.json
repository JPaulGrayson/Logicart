{
  "code": "// ================================================\n// INTEGRATION EXAMPLE: API Handler with LogiGo\n// ================================================\n// Shows how to visualize request processing flow\n// Demonstrates: validation, rate limiting, error paths\n\n// --- REQUEST VALIDATOR ---\n// @logigo: Validate incoming request\nasync function validateRequest(request) {\n  await LogiGo.checkpoint('validate:start', { \n    variables: { hasBody: !!request.body } \n  });\n  \n  // @logigo: Check if body exists\n  if (!request.body) {\n    await LogiGo.checkpoint('validate:fail', { \n      color: '#e74c3c',\n      variables: { error: 'Missing body' }\n    });\n    return { valid: false, error: 'Missing body' };\n  }\n  \n  // @logigo: Check required fields\n  if (!request.body.email) {\n    await LogiGo.checkpoint('validate:fail', { \n      color: '#e74c3c',\n      variables: { error: 'Missing email' }\n    });\n    return { valid: false, error: 'Missing email' };\n  }\n  \n  // @logigo: Validate email format\n  const emailRegex = /^[^@]+@[^@]+\\.[^@]+$/;\n  if (!emailRegex.test(request.body.email)) {\n    await LogiGo.checkpoint('validate:fail', { \n      color: '#e74c3c',\n      variables: { error: 'Invalid email' }\n    });\n    return { valid: false, error: 'Invalid email format' };\n  }\n  \n  // @logigo: Request is valid\n  await LogiGo.checkpoint('validate:pass', { \n    color: '#2ecc71',\n    variables: { email: request.body.email }\n  });\n  return { valid: true };\n}\n\n// --- RATE LIMITER ---\n// @logigo: Rate limit storage\nconst rateLimits = {};\n\n// @logigo: Check rate limit\nasync function checkRateLimit(clientId) {\n  const now = Date.now();\n  const windowMs = 60000;\n  const maxRequests = 10;\n  \n  await LogiGo.checkpoint('ratelimit:check', { \n    variables: { clientId } \n  });\n  \n  // @logigo: Initialize client record\n  if (!rateLimits[clientId]) {\n    rateLimits[clientId] = { count: 0, resetAt: now + windowMs };\n    await LogiGo.checkpoint('ratelimit:new_client', { \n      color: '#3498db',\n      variables: { clientId }\n    });\n  }\n  \n  const client = rateLimits[clientId];\n  \n  // @logigo: Check if window expired\n  if (now > client.resetAt) {\n    // @logigo: Reset window\n    client.count = 0;\n    client.resetAt = now + windowMs;\n  }\n  \n  // @logigo: Increment count\n  client.count++;\n  \n  // @logigo: Check limit\n  if (client.count > maxRequests) {\n    await LogiGo.checkpoint('ratelimit:exceeded', { \n      color: '#e74c3c',\n      variables: { count: client.count, max: maxRequests }\n    });\n    return { allowed: false, retryAfter: client.resetAt - now };\n  }\n  \n  // @logigo: Request allowed\n  await LogiGo.checkpoint('ratelimit:allowed', { \n    color: '#2ecc71',\n    variables: { remaining: maxRequests - client.count }\n  });\n  return { allowed: true, remaining: maxRequests - client.count };\n}\n\n// --- REQUEST HANDLER ---\n// @logigo: Handle API request\nasync function handleRequest(request) {\n  await LogiGo.checkpoint('request:received', { \n    variables: { clientId: request.clientId }\n  });\n  \n  // @logigo: Check rate limit first\n  const rateCheck = await checkRateLimit(request.clientId);\n  if (!rateCheck.allowed) {\n    await LogiGo.checkpoint('response:429', { color: '#e74c3c' });\n    return { status: 429, body: { error: 'Too many requests' } };\n  }\n  \n  // @logigo: Validate request\n  const validation = await validateRequest(request);\n  if (!validation.valid) {\n    await LogiGo.checkpoint('response:400', { color: '#e74c3c' });\n    return { status: 400, body: { error: validation.error } };\n  }\n  \n  // @logigo: Process request\n  const result = { id: Date.now(), email: request.body.email };\n  \n  // @logigo: Return success\n  await LogiGo.checkpoint('response:200', { \n    color: '#2ecc71',\n    variables: { result }\n  });\n  return { status: 200, body: result };\n}\n\n// --- TEST THE FLOW ---\nasync function runDemo() {\n  const testRequest = {\n    clientId: 'user-123',\n    body: { email: 'test@example.com' }\n  };\n  await handleRequest(testRequest);\n}\n\nrunDemo();",
  "nodes": [],
  "edges": []
}