!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).LogiGo={})}(this,function(e){"use strict";class t{constructor(e={}){this.options={speed:e.speed||1,debug:e.debug||!1,position:e.position||"bottom-right",...e},this.isPlaying=!1,this.currentSpeed=this.options.speed,this.overlayElement=null,this.nodes=[],this.activeNodeId=null,this.executionController=new ExecutionController({speed:this.options.speed,debug:this.options.debug})}init(){return this.options.debug&&console.log("[LogiGo] Initializing overlay...",this.options),this.createOverlay(),this.attachEventListeners(),window.LogiGo={checkpoint:this.checkpoint.bind(this),setSpeed:this.setSpeed.bind(this),play:this.play.bind(this),pause:this.pause.bind(this),reset:this.reset.bind(this)},this.options.debug&&console.log("[LogiGo] Overlay initialized. Use window.LogiGo to control."),this}createOverlay(){const e=document.createElement("div");e.id="logigo-overlay",e.style.cssText=`\n      position: fixed;\n      ${this.getPositionStyles()}\n      z-index: 9999;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      border-radius: 12px;\n      padding: 16px;\n      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n      min-width: 280px;\n      backdrop-filter: blur(10px);\n    `;const t=document.createElement("div");t.style.cssText="\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      margin-bottom: 12px;\n    ",t.innerHTML='\n      <div style="display: flex; align-items: center; gap: 8px;">\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">\n          <circle cx="12" cy="12" r="10"/>\n          <polyline points="12 6 12 12 16 14"/>\n        </svg>\n        <span style="color: white; font-weight: 600; font-size: 14px;">LogiGo</span>\n      </div>\n      <button id="logigo-close" style="\n        background: rgba(255,255,255,0.2);\n        border: none;\n        color: white;\n        width: 24px;\n        height: 24px;\n        border-radius: 50%;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      ">Ã—</button>\n    ';const o=document.createElement("div");o.style.cssText="\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    ",o.innerHTML=`\n      <button id="logigo-play" style="${this.getButtonStyles()}">\n        <svg width="16" height="16" viewBox="0 0 24 24" fill="white">\n          <polygon points="5 3 19 12 5 21 5 3"/>\n        </svg>\n      </button>\n      <button id="logigo-pause" style="${this.getButtonStyles()}" disabled>\n        <svg width="16" height="16" viewBox="0 0 24 24" fill="white">\n          <rect x="6" y="4" width="4" height="16"/>\n          <rect x="14" y="4" width="4" height="16"/>\n        </svg>\n      </button>\n      <button id="logigo-step" style="${this.getButtonStyles()}">\n        <svg width="16" height="16" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">\n          <line x1="5" y1="12" x2="19" y2="12"/>\n          <polyline points="12 5 19 12 12 19"/>\n        </svg>\n      </button>\n      <button id="logigo-reset" style="${this.getButtonStyles()}">\n        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">\n          <polyline points="1 4 1 10 7 10"/>\n          <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/>\n        </svg>\n      </button>\n    `;const i=document.createElement("div");i.style.cssText="\n      margin-top: 12px;\n    ",i.innerHTML=`\n      <label style="color: white; font-size: 12px; display: block; margin-bottom: 4px;">\n        Speed: <span id="logigo-speed-value">${this.currentSpeed.toFixed(1)}x</span>\n      </label>\n      <input \n        type="range" \n        id="logigo-speed" \n        min="0.1" \n        max="2.0" \n        step="0.1" \n        value="${this.currentSpeed}"\n        style="width: 100%; cursor: pointer;"\n      />\n    `;const n=document.createElement("div");n.id="logigo-status",n.style.cssText="\n      margin-top: 12px;\n      padding: 8px;\n      background: rgba(255,255,255,0.1);\n      border-radius: 6px;\n      color: white;\n      font-size: 12px;\n      text-align: center;\n    ",n.textContent="Ready",e.appendChild(t),e.appendChild(o),e.appendChild(i),e.appendChild(n),document.body.appendChild(e),this.overlayElement=e}getPositionStyles(){const e={"bottom-right":"bottom: 20px; right: 20px;","bottom-left":"bottom: 20px; left: 20px;","top-right":"top: 20px; right: 20px;","top-left":"top: 20px; left: 20px;"};return e[this.options.position]||e["bottom-right"]}getButtonStyles(){return"\n      background: rgba(255,255,255,0.2);\n      border: none;\n      color: white;\n      padding: 8px 12px;\n      border-radius: 6px;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      transition: all 0.2s;\n      flex: 1;\n    "}attachEventListeners(){document.getElementById("logigo-play")?.addEventListener("click",()=>{this.play()}),document.getElementById("logigo-pause")?.addEventListener("click",()=>{this.pause()}),document.getElementById("logigo-step")?.addEventListener("click",()=>{this.step()}),document.getElementById("logigo-reset")?.addEventListener("click",()=>{this.reset()}),document.getElementById("logigo-speed")?.addEventListener("input",e=>{const t=parseFloat(e.target.value);this.setSpeed(t),document.getElementById("logigo-speed-value").textContent=`${t.toFixed(1)}x`}),document.getElementById("logigo-close")?.addEventListener("click",()=>{this.destroy()})}async checkpoint(e){this.options.debug&&console.log(`[LogiGo] Checkpoint: ${e}`),this.activeNodeId=e,this.updateStatus(`At: ${e}`),this.highlightElement(e),await this.executionController.checkpoint(e),this.removeHighlight(e)}highlightElement(e){const t=document.getElementById(e);t&&(t.style.boxShadow="0 0 10px 2px gold",t.style.transition="box-shadow 0.3s")}removeHighlight(e){const t=document.getElementById(e);t&&(t.style.boxShadow="")}play(){this.isPlaying=!0,this.executionController.play(),this.updateStatus("Playing..."),document.getElementById("logigo-play").disabled=!0,document.getElementById("logigo-pause").disabled=!1}pause(){this.isPlaying=!1,this.executionController.pause(),this.updateStatus("Paused"),document.getElementById("logigo-play").disabled=!1,document.getElementById("logigo-pause").disabled=!0}step(){this.executionController.step(),this.updateStatus("Stepped")}reset(){this.isPlaying=!1,this.activeNodeId=null,this.executionController.reset(),this.updateStatus("Reset"),document.getElementById("logigo-play").disabled=!1,document.getElementById("logigo-pause").disabled=!0}setSpeed(e){this.currentSpeed=e,this.executionController.setSpeed(e),this.options.debug&&console.log(`[LogiGo] Speed set to ${e}x`)}updateStatus(e){const t=document.getElementById("logigo-status");t&&(t.textContent=e)}destroy(){this.overlayElement&&(this.overlayElement.remove(),this.overlayElement=null),delete window.LogiGo,this.options.debug&&console.log("[LogiGo] Overlay destroyed")}}"undefined"!=typeof window&&(window.LogiGoOverlay=t,window.logigoConfig&&new t(window.logigoConfig).init()),"undefined"!=typeof module&&module.exports&&(module.exports=t);let o=class{constructor(e={}){this.options={speed:e.speed||1,debug:e.debug||!1,...e},this.isPaused=!1,this.isWaitingForStep=!1,this.currentSpeed=this.options.speed,this.stepResolvers=[],this.executionHistory=[]}async checkpoint(e){this.options.debug&&console.log(`[ExecutionController] Checkpoint: ${e}`),this.executionHistory.push({nodeId:e,timestamp:Date.now(),speed:this.currentSpeed}),this.isPaused&&(this.options.debug&&console.log(`[ExecutionController] Paused at ${e}, waiting for step/play`),await this.waitForStep());const t=1e3/this.currentSpeed;this.options.debug&&console.log(`[ExecutionController] Waiting ${t}ms at ${e} (speed: ${this.currentSpeed}x)`),await this.sleep(t)}waitForStep(){return new Promise(e=>{this.stepResolvers.push(e),this.isWaitingForStep=!0})}step(){if(this.stepResolvers.length>0){this.stepResolvers.shift()(),this.isWaitingForStep=this.stepResolvers.length>0,this.options.debug&&console.log(`[ExecutionController] Stepped (${this.stepResolvers.length} waiting)`)}}play(){for(this.isPaused=!1;this.stepResolvers.length>0;){this.stepResolvers.shift()()}this.isWaitingForStep=!1,this.options.debug&&console.log("[ExecutionController] Playing")}pause(){this.isPaused=!0,this.options.debug&&console.log("[ExecutionController] Paused")}reset(){this.isPaused=!1,this.isWaitingForStep=!1,this.stepResolvers=[],this.executionHistory=[],this.options.debug&&console.log("[ExecutionController] Reset")}setSpeed(e){this.currentSpeed=Math.max(.1,Math.min(2,e)),this.options.debug&&console.log(`[ExecutionController] Speed set to ${this.currentSpeed}x`)}getState(){return{isPaused:this.isPaused,isWaitingForStep:this.isWaitingForStep,currentSpeed:this.currentSpeed,historyLength:this.executionHistory.length,waitingCheckpoints:this.stepResolvers.length}}getHistory(){return[...this.executionHistory]}sleep(e){return new Promise(t=>setTimeout(t,e))}};"undefined"!=typeof module&&module.exports&&(module.exports=o),"undefined"!=typeof window&&(window.ExecutionController=o);class i{constructor(e={}){this.options={debug:e.debug||!1,...e}}parse(e){this.options.debug&&console.log("[LogiGo Parser] Parsing code...");const t=[],o=e.split("\n");let i=0;return o.forEach((e,o)=>{const n=e.trim();if(n&&!n.startsWith("//"))if(n.match(/^function\s+(\w+)/)){const e=n.match(/^function\s+(\w+)/);t.push({id:"node_"+i++,type:"function",label:`Function: ${e[1]}`,code_ref:e[1],line:o+1,code:n})}else if(n.match(/^if\s*\(/)){const e=n.match(/if\s*\((.*?)\)/)?.[1]||"condition";t.push({id:"node_"+i++,type:"branch",label:`If: ${e}`,code_ref:`if_${o}`,line:o+1,code:n})}else if(n.match(/^(for|while)\s*\(/)){const e=n.match(/^(for|while)/)[1];t.push({id:"node_"+i++,type:"loop",label:`${e.toUpperCase()} Loop`,code_ref:`${e}_${o}`,line:o+1,code:n})}else n.match(/^return\s/)?t.push({id:"node_"+i++,type:"return",label:"Return",code_ref:`return_${o}`,line:o+1,code:n}):n.length>0&&t.push({id:"node_"+i++,type:"statement",label:n.substring(0,30)+(n.length>30?"...":""),code_ref:`stmt_${o}`,line:o+1,code:n})}),this.options.debug&&console.log(`[LogiGo Parser] Parsed ${t.length} nodes`),t}parseToGraph(e){const t=this.parse(e),o=[];for(let e=0;e<t.length-1;e++)o.push({id:`edge_${e}`,source:t[e].id,target:t[e+1].id,type:"default"});return{nodes:t,edges:o}}}"undefined"!=typeof module&&module.exports&&(module.exports=i),"undefined"!=typeof window&&(window.LogiGoParser=i);class n{constructor(e={}){this.options={debug:e.debug||!1,matchBy:e.matchBy||"id",...e}}diffTrees(e,t){this.options.debug&&console.log("[LogiGoDiffer] Comparing trees...",{oldNodes:e.length,newNodes:t.length});const o={nodes:[],stats:{added:0,removed:0,modified:0,unchanged:0}},i=new Map(e.map(e=>[this.getNodeKey(e),e])),n=new Map(t.map(e=>[this.getNodeKey(e),e]));return t.forEach(e=>{const t=this.getNodeKey(e),n=i.get(t);n?this.nodesAreDifferent(n,e)?(o.nodes.push({...e,diffStatus:"modified",className:"node-modified",oldValue:n}),o.stats.modified++):(o.nodes.push({...e,diffStatus:"unchanged",className:"node-unchanged"}),o.stats.unchanged++):(o.nodes.push({...e,diffStatus:"added",className:"node-added"}),o.stats.added++)}),e.forEach(e=>{const t=this.getNodeKey(e);n.has(t)||(o.nodes.push({...e,diffStatus:"deleted",className:"node-deleted"}),o.stats.removed++)}),this.options.debug&&console.log("[LogiGoDiffer] Diff complete:",o.stats),o}getNodeKey(e){return"signature"===this.options.matchBy?this.getNodeSignature(e):e.id||e.code_ref||e.label}getNodeSignature(e){return[e.type,e.label?.toLowerCase().replace(/\s+/g,"_"),e.line].filter(Boolean).join("::")}nodesAreDifferent(e,t){const o=["label","code","type","line"];for(const i of o)if(e[i]!==t[i])return!0;return!1}applyDiffStyles(e){return e.map(e=>{const t=this.getStylesForStatus(e.diffStatus);return{...e,style:t}})}getStylesForStatus(e){const t={added:{border:"2px solid #28a745",backgroundColor:"#d4edda",animation:"pulse 1s ease-in-out"},deleted:{border:"2px solid #dc3545",backgroundColor:"#f8d7da",opacity:"0.5"},modified:{border:"2px solid #ffc107",backgroundColor:"#fff3cd"},unchanged:{border:"1px solid #dee2e6",backgroundColor:"#f8f9fa"}};return t[e]||t.unchanged}getSummary(e){const{stats:t}=e,o=t.added+t.removed+t.modified+t.unchanged,i=[];return t.added>0&&i.push(`${t.added} added`),t.removed>0&&i.push(`${t.removed} removed`),t.modified>0&&i.push(`${t.modified} modified`),t.unchanged>0&&i.push(`${t.unchanged} unchanged`),`${o} nodes: ${i.join(", ")}`}filterByStatus(e,t){return e.filter(e=>e.diffStatus===t)}getChanges(e){return e.filter(e=>"added"===e.diffStatus||"modified"===e.diffStatus||"deleted"===e.diffStatus)}}function s(e={}){const o=new t(e);return o.init(),{overlay:o,checkpoint:o.checkpoint.bind(o),play:o.play.bind(o),pause:o.pause.bind(o),step:o.step.bind(o),reset:o.reset.bind(o),setSpeed:o.setSpeed.bind(o),destroy:o.destroy.bind(o)}}"undefined"!=typeof module&&module.exports&&(module.exports=n),"undefined"!=typeof window&&(window.LogiGoDiffer=n);var d={init:s,LogiGoOverlay:t,ExecutionController:o,LogiGoParser:i,LogiGoDiffer:n};e.ExecutionController=o,e.LogiGoDiffer=n,e.LogiGoOverlay=t,e.LogiGoParser=i,e.default=d,e.init=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=logigo.min.js.map
